name: Daily Project Roadmap → Notion (Yesterday Done / Today In Progress & Todo)

"on":
  schedule:
    - cron: "0 0 * * *"   # 00:00 UTC == 09:00 KST
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: read
      pull-requests: read
    steps:
      - uses: actions/checkout@v4

      - name: Debug show files
        run: |
          pwd
          ls -la
          echo "--- scripts ---"
          ls -la scripts || true

      - uses: actions/setup-node@v4
        with:
          node-version: "20"

      - run: npm install --no-audit --no-fund

      - name: Build Roadmap report & export to Notion
        run: npm start
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
          PROJECT_OWNER: jeonglee22
          PROJECT_NUMBER: 7
          TIMEZONE: Asia/Seoul
          # 오프셋: 보고 기준 일(기본 오늘). 0=오늘 스냅샷, 1=어제 스냅샷 등
          REPORT_OFFSET_DAYS: "0"
          # Notion (선택)
          NOTION_TOKEN: ${{ secrets.NOTION_TOKEN }}
          NOTION_DB_ID: ${{ secrets.NOTION_DB_ID }}